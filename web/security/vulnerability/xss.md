Атака
XSS (Cross-Site Scripting) - выполнение javascript кода, внедренного злоумышленником, в браузере жертвы в контексте нашего сайта.

XSS бывают нескольких видов, их классификация приведена ниже:

 Виды XSS
 Stored XSS
Вид XSS, когда сторонний html/javascript код попадают на страницу однажды и срабатывают каждый раз при посещении этой страницы другими пользователями.

 Reflected XSS
Вид XSS, при котором вредоносный javascript вставляется в страницу не из пользовательского ввода в приложении, а через параметр в урле.

Например https://kontur.ru/?a=<script>alert()</script>. Если значение параметра подставляется в страницу без санитизации, то каждый раз при переходе по специально созданной ссылке у жертвы будет выполняться javascript код в контексте сайта, куда эта ссылка ведет.

 Self XSS
Вид XSS, при которой пользователь может атаковать только сам себя.

Например, ввести в адресную строку браузера javascript:alert() и нажать Enter.

Или возможность внедрить левый javascript в страничку веб-приложения, которую может видеть только тот, кто его туда и внедрил.

Сама по себе безобидна, но в сочетании с CSRF, clickjacking'ом или плохо настроеным CORS можно превратить в полноценную XSS.

Возможные последствия:
Выполнение действий от имени пользователя
Кража сессии
Cookie без httpOnly флага
Токен в теле страницы
Токен в localStorage.
Отображение любой информации на сайте
Выполнение произвольного кода на компьютере пользователя (через взаимодействие с контур плагином / тулбоксом)


 Защита
Энкодинг. Если символы <>'"&: попадают в html страничку, то их необходимо энкодить в html entities.
Типизация. Ожидаешь число? Не принимай ничего другого.
Санитизация. Не очень user-friendly, но можно не принимать угловые скобки <> (а желательно еще и другие символы ':"&) или вырезать их.
Location. Если пользовательский ввод передается в <a href="...">, window.location или <iframe src="...">, то необходимо принимать только схему http(s)://
Частично можно обезопаситься вот этим.
CSP. Это подробно описано здесь и здесь.



 Рекомендации
Для тестировщиков:
Во все возможные поля и параметры вводить пейлоады, которые можно взять здесь, и смотреть где выстрелит XSS
Для разработчиков убедиться что:
Символы <>':"&, которые попадают в страничку, энкодятся
Правильно работают типизация и санитизация (если они есть)
Пользовательские ссылки подтягиваются в теги и window.location только по схеме http(s)://